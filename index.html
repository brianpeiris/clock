<!doctype html>
<html>
	<head>
		<title>clock</title>

		<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.1/build/reset-fonts-grids/reset-fonts-grids.css">
		<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.1/build/base/base-min.css">

		<style type="text/css">
			html { overflow: hidden; font-size: 12pt; background-color: black; color: white; }
			body { margin: 2em; padding: 0; }
			#clock {
				font-size: 40pt;
				margin-top: -5pt;
				text-align: center;
			}
			#clock, #date { margin-left: 60pt; }
			.label { font-weight: bold; }
			.yui-gf { margin-top: 1pt; }
			.yui-gf .yui-u.first { width: 15%; overflow: hidden; text-align: right; padding-top: 4pt; }
			.yui-gf .yui-u { width: 83%; }
			.progress { height: 2.6em; }
		</style>

		<script type="text/javascript" src="excanvas.compiled.js"></script>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
		<script type="text/javascript" src="jquery.flot.js"></script>

		<script type="text/javascript">
			(function ($) {
				var clock, hours, minutes, seconds;

				$.fn.clock = function () {
					clock = this;

					hours = clock.find(".hours");
					minutes = clock.find(".minutes");
					seconds = clock.find(".seconds");

					setInterval(tick, 500);

					return clock;
				};

				function tick() {
					var
						time = new Date()
						, _hours = time.getHours()
						, _minutes = time.getMinutes()
						, _seconds = time.getSeconds();

					hours.text(pad(_hours));
					minutes.text(pad(_minutes));
					seconds.text(pad(_seconds));

					clock.trigger(
						"tick"
						, [
							time.getTime()
							, _hours
							, _minutes
							, _seconds
						]
					);
				}

				function pad(text, num) {
					num = num || 2;
					text = text.toString();
					var originalTextLength = text.length;
					for (var ii = 0; ii < (num - originalTextLength); ii++) {
						text = "0" + text;
					}
					return text;
				}
			})(jQuery);

			$(function () {
				var
					dateOutput = $("#date")
					, minuteProgress = $("#minuteProgress")
					, hourProgress = $("#hourProgress")
					, dayProgress = $("#dayProgress")
					, weekProgress = $("#weekProgress")
					, monthProgress = $("#monthProgress")
					, yearProgress = $("#yearProgress")
					, decadeProgress = $("#decadeProgress")
					, daysThisMonth = getDaysThisMonth()
					, SECONDS_PER_MINUTE = 60
					, SECONDS_PER_HOUR = 60 * SECONDS_PER_MINUTE
					, SECONDS_PER_DAY = 24 * SECONDS_PER_HOUR
					, SECONDS_PER_WEEK = 7 * SECONDS_PER_DAY
					, SECONDS_THIS_MONTH = daysThisMonth * SECONDS_PER_DAY
					, MONTHS_PER_YEAR = 12
					, YEARS_PER_DECADE = 10
					, dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
					, monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];

				$("#clock").clock().bind("tick", function (event, time, hours, minutes, seconds) {
					var
						time = new Date(time)	
						, days = time.getDay()
						, date = time.getDate()
						, month = time.getMonth()
						, century = Math.floor(time.getFullYear() / 10) * 10
						, yearThisDecade = time.getFullYear() - century
						, _hourProgress = minutes * SECONDS_PER_MINUTE + seconds
						, _dayProgress = hours * SECONDS_PER_HOUR + _hourProgress
						, _weekProgress = days * SECONDS_PER_DAY + _dayProgress
						, _monthProgress = date * SECONDS_PER_DAY + _dayProgress
						, _yearProgress = month * SECONDS_THIS_MONTH + _monthProgress
						, _decadeProgress =  yearThisDecade * MONTHS_PER_YEAR * SECONDS_THIS_MONTH + _yearProgress
						, plots = [
							[minuteProgress, seconds, SECONDS_PER_MINUTE, '#FF2800']
							, [hourProgress, _hourProgress, SECONDS_PER_HOUR, '#FF8B00', function (x) { return x / SECONDS_PER_HOUR * 60; }, 5 * SECONDS_PER_MINUTE]
							, [dayProgress, _dayProgress, SECONDS_PER_DAY, '#0780CC', function (x) { return x / SECONDS_PER_DAY * 24; }, 1 * SECONDS_PER_HOUR]
							, [weekProgress, _weekProgress, SECONDS_PER_WEEK, '#00DA4A', function (x) { return dayNames[x / SECONDS_PER_WEEK * 7] || ""; }, 1 * SECONDS_PER_DAY]
							, [monthProgress, _monthProgress, SECONDS_THIS_MONTH, '#FF2800', function (x) { return x / SECONDS_THIS_MONTH * daysThisMonth; }, 7 * SECONDS_PER_DAY]
							, [yearProgress, _yearProgress, SECONDS_THIS_MONTH * MONTHS_PER_YEAR, '#FF8B00', function (x) { return monthNames[x / SECONDS_THIS_MONTH] || ""; }, SECONDS_THIS_MONTH]
							, [decadeProgress, _decadeProgress, SECONDS_THIS_MONTH * MONTHS_PER_YEAR * YEARS_PER_DECADE, '#0780CC', function (x) { return x / SECONDS_THIS_MONTH / MONTHS_PER_YEAR + century; }, MONTHS_PER_YEAR * SECONDS_THIS_MONTH]
						];
						for (var plotIndex in plots) {
							plot.apply(this, plots[plotIndex]);
						}
					dateOutput.text((new Date()).toDateString());
				});

				function getDaysThisMonth(date) {
					date = date || new Date();
					date.setDate(1);
					date.setMonth(date.getMonth() + 1);
					date.setDate(0);
					return date.getDate();
				}

				function plot(element, value, max, color, formatter, interval) {
					$.plot(
						element
						, [[[value, 0]]]
						, {
							series: {
								bars: { show: true, horizontal: true, lineWidth: 0, fillColor: color }
								, shadowSize: 0
							}
							, xaxis: { min: 0, max: max, tickFormatter: formatter, tickSize: interval }
							, yaxis: { min: 0, max: 1, ticks: 0 }
							, grid: { aboveData: true, color: 'white', tickColor: 'white', borderWidth: 1, borderColor: 'white' }
						}
					);
				}
			});
		</script>
		<script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-1234747-4']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script>
	</head>
	<body>
		<div id="clock">
			<span class="hours"></span>:<span class="minutes"></span>:<span class="seconds"></span>
		</div>
		<div id="date"></div>
		<div class="yui-gf">
			<div class="yui-u first"><span class="label">minute:</span></div>
			<div class="yui-u"><div id="minuteProgress" class="progress"></div></div>
		</div>
		<div class="yui-gf">
			<div class="yui-u first"><span class="label">hour:</span></div>
			<div class="yui-u"><div id="hourProgress" class="progress"></div></div>
		</div>
		<div class="yui-gf">
			<div class="yui-u first"><span class="label">day:</span></div>
			<div class="yui-u"><div id="dayProgress" class="progress"></div></div>
		</div>
		<div class="yui-gf">
			<div class="yui-u first"><span class="label">week:</span></div>
			<div class="yui-u"><div id="weekProgress" class="progress"></div></div>
		</div>
		<div class="yui-gf">
			<div class="yui-u first"><span class="label">month:</span></div>
			<div class="yui-u"><div id="monthProgress" class="progress"></div></div>
		</div>
		<div class="yui-gf">
			<div class="yui-u first"><span class="label">year:</span></div>
			<div class="yui-u"><div id="yearProgress" class="progress"></div></div>
		</div>
		<div class="yui-gf">
			<div class="yui-u first"><span class="label">decade:</span></div>
			<div class="yui-u"><div id="decadeProgress" class="progress"></div></div>
		</div>
	</body>
</html>
